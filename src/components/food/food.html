<ion-item-sliding #item margin-top>

    <button ion-item (click)="doClick()" class="food-item card">
        <h2>{{ food.name }} <span *ngIf="selection()">({{ selection() }})</span></h2>
        <p>{{ food.manufacturer }}</p>
        <div class="nutrition-container" item-end>
        </div>

        <ion-grid class="nutrition">
            <ion-row>
                <ng-container class="nutrition" *ngIf="food.carb_factor >= 0.0 && food.carb_factor <= 1.0 && !selection() && !editMode && !selectionMode" item-end>
                    <ion-col><ion-badge *ngIf="showCarbs" color="light">Carb {{ round(food.carb_factor * 100.0) }}%</ion-badge></ion-col>
                    <ion-col><ion-badge *ngIf="showProteins" color="light">Prot {{ round(food.protein_factor * 100.0) }}%</ion-badge></ion-col>
                    <ion-col><ion-badge *ngIf="showFats" color="light">Fats {{ round(food.fat_factor * 100.0) }}%</ion-badge></ion-col>
                    <ion-col><ion-badge *ngIf="showFiber" color="light">Fibe {{ round(food.fiber_factor * 100.0) }}%</ion-badge></ion-col>
                    <ion-col><ion-badge *ngIf="showAlcohol" color="light">Alco {{ round(food.alcohol_factor * 100.0) }}%</ion-badge></ion-col>
                </ng-container>

                <ng-container class="nutrition" *ngIf="selection()">
                    <ion-col>
                        <ion-badge *ngIf="showCarbs" color="secondary">Carb<br/>{{ round(weight() * food.carb_factor) }}g</ion-badge>
                        <ion-badge *ngIf="showProteins" color="secondary">Prot<br/>{{ round(weight() * food.protein_factor) }}g</ion-badge>
                        <ion-badge *ngIf="showFats" color="secondary">Fats<br/>{{ round(weight() * food.fat_factor) }}g</ion-badge>
                        <ion-badge *ngIf="showKCal" color="secondary">Kcal<br/>{{ kcal() }}</ion-badge>
                    </ion-col>
                </ng-container>
            </ion-row>

        </ion-grid>

        <div item-content>

            <div *ngIf="editMode && !currentlySelected" [@fadeInOut]>
                <food-editor (editFinished)="editFinishedCallback($event)" [food]="food"></food-editor>
            </div>

            <div *ngIf="selectionMode" [@fadeInOut]>
                <food-selection [currentlySelected]="currentlySelected" (selectionFinished)="selectionFinishedCallback($event)" [food]="food"></food-selection>
            </div>

        </div>
    </button>


    <ion-item-options *ngIf="!editMode && !selectionMode" side="right">

        <!-- Favorite food -->
        <button ion-button color="light" (click)="favorite(item, true)" *ngIf="!food.source_name && !food.favorite && !currentlySelected"><ion-icon name="heart"></ion-icon>Favorite</button>

        <!-- Unfavorite food -->
        <button ion-button color="light" (click)="favorite(item, false)" *ngIf="!food.source_name && food.favorite && !currentlySelected"><ion-icon name="heart-outline"></ion-icon>Unfav</button>
    
        <!-- Edit food -->
        <button ion-button color="light" (click)="edit(item)" *ngIf="!food.source_name && !currentlySelected"><ion-icon name="create"></ion-icon>Edit</button> 

        <!-- Delete food -->
        <button ion-button color="danger" (click)="delete(item)" *ngIf="!food.source_name && !currentlySelected"><ion-icon name="trash"></ion-icon>Delete</button> 

        <!-- Save remove food to local foods -->
        <button ion-button color="secondary" (click)="save(item)" *ngIf="!!food.source_name && !food.id && !currentlySelected">
            <ion-icon name="cloud-download"></ion-icon>Save
        </button>

        <!-- Remove from food selected list -->
        <button ion-button color="danger" (click)="unselect(item)" *ngIf="currentlySelected"><ion-icon name="remove"></ion-icon>Remove</button> 

    </ion-item-options>


</ion-item-sliding>